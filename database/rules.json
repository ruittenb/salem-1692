{
  "rules": {
    ".read": false,
    ".write": false,
    "games": {
      ".read": false,
      ".write": true,
      "$game_id": {
        ".read": true,
        ".write": "
          (
            data.exists() /* either this is an insert, or the client must provide the correct auth key */
            || newData.child('auth_key').val() == data.child('auth_key').val()
          )
          && newData.child('game_id').val() == $game_id
          && newData.child('game_id').val() == data.child('game_id').val() /* same id */
          && newData.child('game_id').val().matches(/^([a-z][0-9][0-9]-){2}[a-z][0-9][0-9]$/)
        ",
        ".validate": "newData.hasChildren([ 'game_id', 'players', 'seating', 'auth_key' ])",
        "game_id":  { ".validate": "newData.isString()" },
        "players":  { ".validate": true, /* there is no "newData.isArray()"? */ },
        "seating":  { ".validate": "newData.isString() && newData.val().matches(/^(One|Two)AtTop$/)" },
        "auth_key": { ".validate": "newData.isString()" },
        "$other":   { ".validate": false }
      }
    }
  }
}
